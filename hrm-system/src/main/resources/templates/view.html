<!DOCTYPE html>
<html lang="en" xmlns:th="http://www.thymeleaf.org">
	<head>
		<meta charset="utf-8">
		<title>Layui</title>
		<meta name="renderer" content="webkit">
		<meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1">
		<meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
		<link rel="stylesheet" th:href="@{'/static/css/layui.css'}" media="all">
	</head>

	<body style="background-color: #fcfcfc">
		<fieldset class="layui-elem-field layui-field-title" style="margin-top: 20px;">
			<legend>编辑部门信息</legend>
		</fieldset>
		<div style="height: 350px; margin-left: 20px; margin-top: 20px; padding-left: 10px; padding-top: 20px;">
			<form class="layui-form layui-form-pane" action="/department/update" method="post" id="form">
				<input name="id" type="hidden" th:value="${department.getID()}"/>
				<div class="layui-form-item">
					<label class="layui-form-label">部门名称</label>
					<div class="layui-input-inline">
						<input type="text" name="name" id="name" lay-verify="required" placeholder="部门名称" style="width: 485px"
							   autocomplete="off" class="layui-input" th:value="${department.name}"/>
					</div>
					<div class="layui-form-mid layui-word-aux" style="margin-left: 300px"><span style="color: lightcoral;">*</span></div>
				</div>
				<div class="layui-form-item layui-form-text" style="width: 595px;">
					<label class="layui-form-label">部门备注</label>
					<div class="layui-input-block">
						<textarea placeholder="部门备注" class="layui-textarea" name="remark" th:text="${department.remark}"></textarea>
					</div>
				</div>
				<div class="layui-form-item" style="margin-left: 530px;">
					<button class="layui-btn" lay-submit="">确认</button>
				</div>
			</form>
		</div>

		<script th:src="@{'/static/layui.js'}" charset="utf-8"></script>
		<!-- 注意：如果你直接复制所有代码到本地，上述js路径需要改成你本地的 -->
		<script>
			layui.use(['form', 'layedit', 'laydate'], function(){
				var form = layui.form;
                var layer = layui.layer;
				var	layedit = layui.layedit;
				var	laydate = layui.laydate;

				//监听submit提交按钮 button ，lay-filter 为 【userUpdate】 的
				form.on('submit(userUpdate)', function(data){
					//此段代码可以获取提交的数据
					/* layer.alert(JSON.stringify(data.field), {
                         title: '最终的提交信息'
                     })*/
					//ajax 提交
					$.ajax({
						type: "POST",
						dataType: "text",
						url: "/user/save" ,//url
						data: $('#popupForm').serialize(),  //表单数据
						success: function (result) {
							if (result = "seccess") {
								layer.msg('修改成功，1秒后自动关闭该窗口');
								//延迟1秒执行，目的是让用户看到提示
								setTimeout( function(){
									//1、先得到当前iframe层（弹出层）的索引  ///2、提交成功关闭弹出层窗口
									var index = parent.layer.getFrameIndex(window.name);
									parent.layer.close(index);
								}, 1 * 1000 );
							};
						},
						error : function() {
							layer.msg('后台异常！未添加成功');
						}
					});
					//阻止页面跳转
					return false;
				});

				//自定义表单验证
				//lay-verify ：对应userr、pass、等，required 为必填项
				form.verify({
					user: function(value){
						if(value.length < 2){
							return '用户名至少得2个字符啊';
						}
					}
					,pass: [
						/^[\S]{6,12}$/
						,'密码必须6到12位，且不能出现空格'
					]
					,content: function(value){
						layedit.sync(editIndex);
					}
				});
			});
		</script>
	</body>

</html>